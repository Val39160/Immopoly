<div class="container-fluid bg-white">
  <div class="container-fluid bg-white text-center">
    <h1 class="index-h1">1. Chercher et ajouter ses adresses</h1>
  </div>

  <div class="d-flex">
    <!-- Section de recherche et carte -->
    <div class="position-relative" style="width: 50%; height: 1340px; m-20">
      <!-- Search Bar -->
      <div class="position-absolute top-0 start-0 p-3" style="z-index: 1000; width: 340px;">
        <%= form_with url: new_property_path, method: :get, class: "d-flex" do %>
          <div class="search-bar-index">
            <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "Entrez l’adresse de votre propriété" %>
            <%= button_tag(type: 'submit', class: "search-index ms-2") do %> <!-- Correction: 'Submit' en 'submit' -->
              <i class="fa-solid fa-magnifying-glass" style="color: #27CE8D;"></i>
            <% end %>
          </div>
        <% end %>
      </div>

      <!-- Map -->
      <div id="home-map" style="width: 100%; height: 100%; border-radius: 10px;"
           data-controller="map"
           data-map-markers-value="<%= @markers.to_json %>"
           data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>

    <!-- Formulaire des propriétés -->
    <div class="card-simple-form ms-4 mb-5" style="width: 40%;">
      <h3 class="title-property-form">Adresse</h3>
      <div class="property-form">
        <%= simple_form_for @property do |f| %>
          <!-- Champs du formulaire -->
          <div class="form-group">
            <%= f.association :city, collection: @cities, label: "Ville" %>
          </div>
          <div class="form-group">
            <%= f.input :area_sqm_land, label: "Surface terrain" %>
          </div>
          <div class="form-group">
            <%= f.input :address, label: "Adresse" %>
          </div>
          <div class="form-group">
            <%= f.input :street_number, label: "Numéro d'adresse" %>
          </div>
          <div class="form-group">
            <%= f.input :street_name, label: "Nom de la rue" %>
          </div>
          <div class="form-group">
            <%= f.input :zipcode, label: "Code postal" %>
          </div>
          <div class="form-group">
            <%= f.input :building_height_floors, label: "Nombre d'étages" %>
          </div>
          <div class="form-group">
            <%= f.input :nb_rooms_per_dwelling, label: "Nombre de pièces par logement" %>
          </div>
          <div class="form-group">
            <%= f.input :energy_class, label: "Classe énergétique" %>
          </div>
          <div class="form-group">
            <%= f.input :floor_area_ratio, label: "Coefficient d'occupation des sols" %>
          </div>
          <div class="form-group">
            <%= f.input :nb_dwelling, label: "Nombre de logements" %>
          </div>
          <div class="form-group">
            <%= f.input :density_area, label: "Zone de densité" %>
          </div>
          <div class="form-group">
            <%= f.input :building_zone, label: "Zone à bâtir" %>
          </div>
          <div class="form-group">
            <%= f.submit "Sauvegarder mon adresse" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Liste des propriétés -->
  <div class="container m-auto">
    <div class="container m-auto">
      <div class="index-card shadow">
        <div class="card-header bg-white d-flex justify-content-center mb-4">
          <h3 id ="index-card-h3">Vos propriétés</p>
        </div>
        <div class="index-scroll card-body bg-white ">
          <% @properties.each do |propertie| %>
            <div class="property-card mb-3 p-3 border rounded-5">
              <h5 class="card-title"><%= propertie.address %></h5>
              <div class="d-flex justify-content-start m-1">
                <div>Lot : <%= propertie.nb_dwelling %></div>
                <div><%= propertie.area_sqm_land %> m² terrain</div>
                <div><%= propertie.area_sqm_livable %> m² habitables</div>
              </div>
            </div>
          <% end %> <!-- Fermeture correcte de la balise ERB -->
        </div>
      </div>
    </div>
  </div>

  <!-- Modal pour créer un projet -->
  <div class="container m-auto text-center">
    <button type="button" class="btn btn-primary m-3 btn-custom-text p-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
      Créer un projet
    </button>
  </div>

  <
